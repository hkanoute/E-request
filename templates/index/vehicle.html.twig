{% extends 'base.html.twig' %}
{% block body %}
    <div class="container text-center d-flex justify-content-center">
        <div class="col-md-3 pt-5">
            {{ form(form) }}
            <button class="mt-3 btn btn-success" id="sheetjsexport"><b>Exporter</b></button>
        </div>
    </div>
    {% if data is defined and data | length > 0%}
        <div class="container col-md-12">
            <table class="table pt-5 mt-5" id="TableToExport">
                <thead>
                <tr>
                    <th scope="col">marke</th>
                    <th scope="col">artnr</th>
                    <th scope="col">Genartnr</th>
                    <th scope="col">Famille</th>
                    <th scope="col">ktypnr</th>
                    <th scope="col">Marque</th>
                    <th scope="col">modele</th>
                    <th scope="col">vehicule</th>
                    <th scope="col">annee_debut</th>
                    <th scope="col">annee_fin</th>
                    <th scope="col">carburant</th>
                </tr>
                </thead>
                <tbody>
                {%for i in 0..data | length - 1  %}
                    <tr>
                        <td>{{ data[i].marke }}</td>
                        <td>{{ data[i].artnr }}</td>
                        <td>{{ data[i].genartnr }}</td>
                        <td>{{ data[i].famille }}</td>
                        <td>{{ data[i].ktypnr }}</td>
                        <td>{{ data[i].marque }}</td>
                        <td>{{ data[i].modele }}</td>
                        <td>{{ data[i].vehicule }}</td>
                        <td>{{ data[i].annee_debut }}</td>
                        <td>{{ data[i].annee_fin }}</td>
                        <td>{{ data[i].carburant }}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    {% endif %}

    <script>
        document.getElementById("sheetjsexport").addEventListener('click', function() {
            /* Create worksheet from HTML DOM TABLE */
            let wb = XLSX.utils.table_to_book(document.getElementById("TableToExport"));
            /* Export to file (start a download) */
            XLSX.writeFile(wb, "ExtractionVehicule.xlsx");
        });
    </script>
{% endblock %}